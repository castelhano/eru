{% extends "layout/app.html" %}
{% load static %}
{% block title %}Marcha{% endblock %}
{% block nav_title %}Diagrama de Marcha{% endblock %}

{% block style_src %}
<link rel="stylesheet" href="{% static 'css/charts.css' %}">
{% endblock %}

{% block add_script_src %}
<script type="module">
    import { metrics as $ } from '{% static 'js/app/trafego/DM_metrics.js' %}';
    import { jsGaitDiagram } from '{% static 'js/app/trafego/DM_main.js' %}';
    import { Route } from '{% static 'js/app/trafego/DM_route.js' %}';
    import { Locale } from '{% static 'js/app/trafego/DM_locale.js' %}';
    import { jsGaitDiagramUI } from '{% static 'js/app/trafego/UI_main.js' %}';
    
    const model = new jsGaitDiagram({
        linha: new Route({
            id: 5,
            prefixo: '301',
            nome: 'Jd Vitoria x Centro',
            circular: true,
            origem: new Locale({id: 12, nome: 'Jd Vitoria', troca_turno: true}),
            destino: new Locale({id: 22, nome: 'Peg Lev', troca_turno: true}),
            extensao_ida: 23.22,
            extensao_volta: 21.10,
            acesso_origem_minutos: 20,
            acesso_destino_minutos: 25,
            recolhe_origem_minutos: 18,
            recolhe_destino_minutos: 16,
            acesso_origem_km: 4.22,
            acesso_destino_km: 5,
            recolhe_origem_km: 4.63,
            recolhe_destino_km: 3.36,
            refs: {
                origem:[{local: new Locale({id: 35, nome: 'Hosp Cancer', troca_turno: true}), delta: 20}],
                destino:[{local: new Locale({id: 19, nome: 'Shop Pantanal', troca_turno: false}), delta: 35}]
            }
        })
    })
    const ui = new jsGaitDiagramUI({
        project: model,
        settingsContainer: document.getElementById('marchSettings_container'),
    })
    window.model = model;  // #DEV: Torna modelo disponivel no console.. comentar essa linha em producao
    window.ui = ui;        // #DEV: Torna ui disponivel no console.. comentar essa linha em producao
</script>
{% endblock %}

{% block content %}<div id="march_container"></div>{% endblock %}
{% block canvasNav %}<div id="marchSettings_container"></div>{% endblock %}


<script>
    {% block add_script %}


    // const marcha = new jsMarcha();

    // let interestPoints = []
    // interestPoints.push(new Localidade({id: 12, nome: 'Jd Vitoria', surrender: true}));
    // interestPoints.push(new Localidade({id: 55, nome: 'Peg Lev'}));
    // interestPoints.push(new Localidade({id: 82, nome: 'Hosp Cancer'}));
    // interestPoints.push(new Localidade({id: 65, nome: 'Igreja Matriz', surrender: true}));

    // const model = new March({
    //     linha: new Linha({
    //         id: 5,
    //         prefixo: '301',
    //         nome: 'Jd Vitoria x Centro',
    //         circular: false,
    //         origem: interestPoints[0],
    //         destino: interestPoints[1],
    //         extensao_ida: 23.22,
    //         extensao_volta: 21.10,
    //         metrics: {
    //             acesso_origem_minutos: 20,
    //             acesso_destino_minutos: 25,
    //             recolhe_origem_minutos: 18,
    //             recolhe_destino_minutos: 16,
    //             acesso_origem_km: 4.22,
    //             acesso_destino_km: 5,
    //             recolhe_origem_km: 4.63,
    //             recolhe_destino_km: 3.36,
    //         },
    //         refs: {origem:[{local: interestPoints[2], delta: 20}], destino:[{local: interestPoints[3], delta: 35}]}
    //     })
    // });
    // model.linha.param[4].demanda_ida = 450;
    // model.linha.param[4].demanda_volta = 85;
    // model.linha.param[5].demanda_ida = 520;
    // model.linha.param[5].demanda_volta = 122;
    // const project = new MarchUI({
    //     container: document.getElementById('march_container'),
    //     settingsContainer: document.getElementById('marchSettings_container'),
    //     project: model,
    //     // initialView: 240,
    //     initialView: '05:00'
    //     // rulerUnit: '2px',
    //     // rulerMediumUnit: 120,
    // });
    {% endblock %}
</script>