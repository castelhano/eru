<script>
    const menuCadastro = new canvasNavDropdown({
        name: '<b>C</b>adastro',
        icon: 'bi bi-list',
        i18n: 'common.register',
        'i18n-bold': 'c',
        itens: [
        {% if perms.trafego.view_linha %}{name: '<b><u>L</u></b>inha', id:'menu_linha', href: '{% url 'trafego_linhas' %}', i18n: 'route.route', 'i18n-bold': 'l', keybind: ['l', ()=>{if(menuCadastro.isOpen()){document.getElementById('menu_linha').click();}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.trafego.view_localidade %}{name: 'L<b><u>o</u></b>calidade', id:'menu_localidade', href: '{% url 'trafego_localidades' %}', i18n: 'route.locale', 'i18n-bold': 'o', keybind: ['o', ()=>{if(menuCadastro.isOpen()){document.getElementById('menu_localidade').click();}}, {display: false, preventDefault: false}]}, {% endif %}
        ],
        keybind: [
            'alt+c',
            (ev)=>{ // Abre menu de cadastro, exibe o canvas Nav caso nao esteja visivel
                canvasNavActive(true); // Exibe o canvasNav (caso oculto)
                menuCadastro.click();
                setTimeout(()=>{menuCadastro.focus()}, 340);
            },
            {i18n: 'route.shortcuts.openRegisterMenu', icon: 'bi bi-layout-sidebar-inset-reverse text-orange', desc:'Abre menu de cadastro'}
        ]
    })
    {% if perms.trafego.view_linha %}appKeyMap.bind('c+l', ()=>{document.getElementById('menu_linha').click()}, {display: false}){% endif %}
    {% if perms.trafego.view_localidade %}appKeyMap.bind('c+o', ()=>{document.getElementById('menu_localidade').click()}, {display: false}){% endif %}
    const menuImportar = new canvasNavDropdown({
        name: 'Impor<b>t</b>ação',
        icon: 'bi bi-person-fill-up',
        i18n: 'common.import',
        'i18n-bold': 't',
        itens: [
        {% if perms.trafego.add_passageiro %}{name: '<b><u>P</u></b>assageiros', i18n: 'route.passenger.passenger', 'i18n-bold': 'p', id:'menu_passageiros_import', href: '{% url 'trafego_passageiros_import' %}', keybind: ['p', ()=>{if(menuImportar.isOpen()){document.getElementById('menu_passageiros_import').click();}}, {display: false, preventDefault: false}]},{% endif %},
        {% if perms.trafego.demanda_update %}{name: 'Atualizar <b><u>D</u></b>emanda', i18n: 'route.shortcuts.demandUpdate', 'i18n-bold': 'd', id:'menu_demanda_update', tagName: 'span', onclick: ()=>{appAlert('warning', 'Em desenvolvimento', {i18n: 'sys.inDevelopment', autodismiss: false})}, keybind: ['d', ()=>{if(menuImportar.isOpen()){document.getElementById('menu_demanda_update').click();}}, {display: false, preventDefault: false}]},{% endif %},
        ],
        keybind: [
            'alt+t',
            (ev)=>{ // Abre menu de cadastro, exibe o canvas Nav caso nao esteja visivel
                canvasNavActive(true); // Exibe o canvasNav (caso oculto)
                menuImportar.click();
                setTimeout(()=>{menuImportar.focus()}, 340);
            },
            {i18n: 'route.shortcuts.openImportMenu', icon: 'bi bi-layout-sidebar-inset-reverse text-orange', desc:'Abre menu de importação'}
        ]
    })
    {% if perms.trafego.add_passageiro %}appKeyMap.bind('t+p', ()=>{document.getElementById('menu_passageiros_import').click()}, {display: false}){% endif %}
    {% if perms.trafego.demanda_update %}appKeyMap.bind('t+d', ()=>{document.getElementById('menu_demanda_update').click()}, {display: false}){% endif %}
    
    {% if perms.trafego.view_planejamento %}
    const menuPlanejamento = new canvasNavLink({
        name: 'Pla<b>n</b>ejamento',
        i18n: 'route.planning',
        'i18n-bold': 'n',
        id: 'menu_planejamento',
        class: 'text-purple',
        icon: 'bi bi-shuffle',
        href: '{% url 'trafego_planejamentos' %}',
        keybind:[
            'alt+p',
            ()=>{
                document.getElementById('menu_planejamento').click();
            },
            {i18n: 'route.shortcuts.planningMenu', icon: 'bi bi-layout-sidebar-inset-reverse text-orange', desc: 'Abre página de planejamentos'}
        ]
    })
    {% endif %}
    {% if perms.trafego.view_passageiro %}
    const menuPassageiro = new canvasNavLink({
        name: 'P<b>a</b>ssageiros',
        i18n: 'route.passenger.passenger',
        'i18n-bold': 'a',
        id: 'menu_passageiro',
        class: 'text-purple',
        icon: 'bi bi-graph-up-arrow',
        href: '{% url 'trafego_passageiros' %}',
        keybind:[
            'alt+a',
            ()=>{
                document.getElementById('menu_passageiro').click();
            },
            {i18n: 'route.shortcuts.passengerMenu', icon: 'bi bi-layout-sidebar-inset-reverse text-orange', desc: 'Abre página de análise de carregamento'}
        ]
    })
    {% endif %}
    
    i18n.addApp('trafego');
</script>