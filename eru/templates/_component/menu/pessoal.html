{% load i18n %}
{% load tag_extra %}
<script>
    const menuCadastro = new canvasNavDropdown({
        name: '{% translate "Cadastro"|hl_str:'c' %}',
        icon: 'bi bi-list',
        itens: [
        {% if perms.pessoal.view_funcionario %}{name: '{% translate "Funcionário"|hl_str:'f' %}', id:'menu_funcionario', href: '{% url 'pessoal:funcionario_list' %}', keybind: ['f', ()=>{if(menuCadastro.isOpen()){document.getElementById('menu_funcionario').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_setor %}{name: '{% translate "Setor"|hl_str:'s' %}', id:'menu_setor', href: '{% url 'pessoal:setor_list' %}', keybind: ['s', ()=>{if(menuCadastro.isOpen()){document.getElementById('menu_setor').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_cargo %}{name: '{% translate "Cargo"|hl_str:'o' %}', id:'menu_cargo', href: '{% url 'pessoal:cargo_list' %}', keybind: ['o', ()=>{if(menuCadastro.isOpen()){document.getElementById('menu_cargo').click()}}, {display: false, preventDefault: false}]},{% endif %}
        ],
        keybind: [
            'alt+c',
            (ev)=>{ // Abre menu de cadastro, exibe o canvas Nav caso nao esteja visivel
                canvasNavActive(true); // Exibe o canvasNav (caso oculto)
                menuCadastro.click();
                setTimeout(()=>{menuCadastro.focus()}, 340);
            },
            {icon: 'bi bi-layout-sidebar-inset-reverse', desc:'{% translate "Abre menu de cadastro" %}'}
        ]
    })
    // Adicionando atalhos diretos Ctrl+c [THEN] E ==> C+E
    {% if perms.pessoal.view_funcionario %}appKeyMap.bind('c+f', ()=>{document.getElementById('menu_funcionario').click()}, {display: false}){% endif %}
    {% if perms.pessoal.view_setor %}appKeyMap.bind('c+s', ()=>{document.getElementById('menu_setor').click()}, {display: false}){% endif %}
    {% if perms.pessoal.view_cargo %}appKeyMap.bind('c+o', ()=>{document.getElementById('menu_cargo').click()}, {display: false}){% endif %}


    const menuEvento = new canvasNavDropdown({
        name: '{% translate "Eventos"|hl_str:'e' %}',
        icon: 'bi bi-braces-asterisk',
        itens: [
        {% if perms.pessoal.view_evento %} {name: '{% translate "Evento"|hl_str:'t' %}', id:'menu_evento', href: '{% url 'pessoal:evento_list' %}', keybind: ['t', ()=>{if(menuEvento.isOpen()){document.getElementById('menu_evento').click()}}, {display: false, preventDefault: false}]}, {% endif %}
        {% if perms.pessoal.view_grupoevento %}{name: '{% translate "Grupo Evento"|hl_str:'g' %}', id:'menu_grupo_evento', href: '{% url 'pessoal:grupoevento_list' %}', keybind: ['g', ()=>{if(menuEvento.isOpen()){document.getElementById('menu_grupo_evento').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_motivoreajuste %}{name: '{% translate "Motivo reajuste"|hl_str:'m' %}', id:'menu_motivo_reajuste', href: '{% url 'pessoal:motivoreajuste_list' %}', keybind: ['m', ()=>{if(menuEvento.isOpen()){document.getElementById('menu_motivo_reajuste').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_eventoempresa %}
        {type: 'separator'},
        {name: '{% translate "Eventos Globais"|hl_str:'v' %}', id:'menu_eventos_globais', href: '{% url 'pessoal:eventorelated_list' 'empresa' 0 %}', keybind: ['v', ()=>{if(menuEvento.isOpen()){document.getElementById('menu_eventos_globais').click()}}, {display: false, preventDefault: false}]},
        {% endif %}
        ],
        keybind: [
            'alt+e',
            (ev)=>{ // Abre menu de cadastro, exibe o canvas Nav caso nao esteja visivel
                canvasNavActive(true); // Exibe o canvasNav (caso oculto)
                menuEvento.click();
                setTimeout(()=>{menuEvento.focus()}, 340);
            },
            {icon: 'bi bi-layout-sidebar-inset-reverse', desc:'{% translate "Abre menu de Ferramentas" %}'}
        ]
        })
    {% if perms.pessoal.view_evento %}appKeyMap.bind('e+t', ()=>{document.getElementById('menu_evento').click()}, {display: false}){% endif %}
    {% if perms.pessoal.view_grupoevento %}appKeyMap.bind('e+g', ()=>{document.getElementById('menu_grupo_evento').click()}, {display: false}){% endif %}
    {% if perms.pessoal.view_motivoreajuste %}appKeyMap.bind('e+m', ()=>{document.getElementById('menu_motivo_reajuste').click()}, {display: false}){% endif %}
    {% if perms.pessoal.view_eventoempresa %}appKeyMap.bind('e+v', ()=>{document.getElementById('menu_eventos_globais').click()}, {display: false}){% endif %}
    {% if perms.pessoal.change_evento %}appKeyMap.bind('e+r', ()=>{document.getElementById('menu_evento_copy').click()}, {keydown: false, keyup: true, display: false}){% endif %}
    

    const menuFolha = new canvasNavDropdown({
        name: '{% translate "Folha"|hl_str:'o' %}',
        icon: 'bi bi-person-vcard',
        itens: [
        {% if perms.pessoal.folha_dashboard %}{name: '{% translate "Dashboard"|hl_str:'d' %}', id:'menu_dashboard', href: '{% url 'pessoal:folha_dashboard' %}', keybind: ['d', ()=>{if(menuFolha.isOpen()){document.getElementById('menu_dashboard').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_turno %}{name: '{% translate "Turno"|hl_str:'t' %}', id:'menu_turno', href: '{% url 'pessoal:turno_list' %}', keybind: ['t', ()=>{if(menuFolha.isOpen()){document.getElementById('menu_turno').click()}}, {display: false, preventDefault: false}]},{% endif %}
        {% if perms.pessoal.view_frequencia %} {name: '{% translate "Frequência"|hl_str:'r' %}', id:'menu_frequencia', href: '{% url 'pessoal:frequencia_list' %}', keybind: ['r', ()=>{if(menuFolha.isOpen()){document.getElementById('menu_frequencia').click()}}, {display: false, preventDefault: false}]}, {% endif %}
        {% if perms.pessoal.view_eventofrequencia %}{name: '{% translate "Evento Frequência"|hl_str:'e' %}', id:'menu_evento_frequencia', href: '{% url 'pessoal:eventofrequencia_list' %}', keybind: ['e', ()=>{if(menuFolha.isOpen()){document.getElementById('menu_evento_frequencia').click()}}, {display: false, preventDefault: false}]},{% endif %}
        ],
        keybind: [
            'alt+o',
            (ev)=>{ // Abre menu de cadastro, exibe o canvas Nav caso nao esteja visivel
                canvasNavActive(true); // Exibe o canvasNav (caso oculto)
                menuFolha.click();
                setTimeout(()=>{menuFolha.focus()}, 340);
            },
            {icon: 'bi bi-layout-sidebar-inset-reverse', desc:'{% translate "Abre menu de Folha" %}'}
        ]
        })
        {% if perms.pessoal.view_frequencia %}appKeyMap.bind('o+d', ()=>{document.getElementById('menu_dashboard').click()}, {display: false}){% endif %}
        {% if perms.pessoal.view_frequencia %}appKeyMap.bind('o+r', ()=>{document.getElementById('menu_frequencia').click()}, {display: false}){% endif %}
        
    {% if perms.pessoal.view_pessoalsettings %}
    const menuSettings = new canvasNavLink({
        name: '{% translate 'Configurações'|hl_str:'u' %}',
        id: 'menu_menuSettings',
        class: 'link',
        icon: 'bi bi-gear-fill',
        href: '{% url 'pessoal:settings_list' %}',
        keybind: [
            'alt+u',
            ()=>{menuSettings.click()},
            {icon: 'bi bi-gear-fill text-purple', desc: '{% translate 'Configurações do módulo'|escapejs %}'}
        ]
    })
    {% endif %}
</script>